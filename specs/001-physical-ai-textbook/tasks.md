# Tasks: Physical AI & Humanoid Robotics Textbook

**Input**: Design documents from `/specs/001-physical-ai-textbook/`
**Prerequisites**: plan.md, spec.md, research.md, data-model.md, contracts/api.yaml

**Tests**: Tests are NOT explicitly requested in the specification, so test tasks are omitted. Focus is on implementation and deployment.

**Organization**: Tasks are grouped by user story (P1-P5) to enable independent implementation and testing of each story.

## Format: `- [ ] [ID] [P?] [Story] Description`

- **Checkbox**: `- [ ]` for incomplete tasks
- **[ID]**: Sequential task number (T001, T002, etc.)
- **[P]**: Parallelizable (different files, no dependencies)
- **[Story]**: User story label (US1, US2, US3, US4, US5)
- **File paths**: Exact paths included in descriptions

## Path Conventions

This is a web application with:
- **Frontend**: Root-level `docs/`, `src/`, `static/`
- **Backend**: `api/` directory
- **Scripts**: `scripts/` directory
- **Config**: Root-level config files

---

## Phase 1: Setup (Shared Infrastructure)

**Purpose**: Initialize project structure and install dependencies

**Tasks**:

- [X] T001 Initialize Docusaurus project with `npx create-docusaurus@3.6.3 . classic --typescript`
- [X] T002 [P] Create project structure: `docs/`, `src/`, `api/`, `scripts/`, `static/`
- [X] T003 [P] Install frontend dependencies in package.json: docusaurus@3.6.3, better-auth@1.3.10, react@18.2
- [X] T004 [P] Create Python virtual environment and install backend dependencies in api/requirements.txt: fastapi, openai, qdrant-client, asyncpg, uvicorn
- [X] T005 [P] Create environment variables template .env.example with placeholders for OPENAI_API_KEY, DATABASE_URL, QDRANT_URL, QDRANT_API_KEY, AUTH_SECRET
- [X] T006 [P] Configure Docusaurus in docusaurus.config.js: site metadata, theme config, plugins (ideal-image, pwa)
- [X] T007 [P] Create Vercel deployment config in vercel.json with API rewrites and environment variables
- [X] T008 [P] Create .gitignore with node_modules/, .env, build/, api/__pycache__/, venv/

---

## Phase 2: Foundational (Blocking Prerequisites)

**Purpose**: Set up database, authentication foundation, and core services needed by all user stories

**Database Setup**:

- [X] T009 Create database schema SQL file in api/database/schema.sql with tables: users, sessions, user_preferences, chapters, content_chunks, chat_messages
- [X] T010 Create database connection module in api/database/connection.py with Neon Postgres connection pooling
- [X] T011 [P] Create database queries module in api/database/queries.py with CRUD operations for all entities

**Authentication Foundation**:

- [X] T012 Configure Better-Auth server in src/lib/auth.ts with Neon Postgres adapter and custom user fields (softwareExperience, hardwareExperience)
- [X] T013 [P] Create Better-Auth client hooks in src/lib/auth-client.ts with useSession, signUp, signIn, signOut
- [X] T014 [P] Create SessionProvider wrapper in src/theme/Root.tsx to wrap Docusaurus app

**Backend API Foundation**:

- [X] T015 Create FastAPI app entry point in api/main.py with CORS, error handlers, and route registration
- [X] T016 [P] Create Pydantic schemas in api/models/schemas.py for all request/response models
- [X] T017 [P] Create OpenAI client service in api/services/openai_client.py with GPT-4o and embedding functions
- [X] T018 [P] Create Qdrant client service in api/services/qdrant_client.py with collection setup and query functions

---

## Phase 3: User Story 1 - Read Educational Content (Priority: P1)

**Goal**: Deploy static textbook with 13 weeks of content across 4 modules

**Independent Test**: Deploy site and verify all chapters display correctly with navigation, syntax highlighting, and consistent formatting

**Content Creation**:

- [X] T019 [P] [US1] Create intro.md in docs/ with course overview and navigation guide
- [X] T020 [P] [US1] Create module-1-ros2/ directory structure with week-1-2-physical-ai-intro/, week-3-5-ros2-fundamentals/
- [X] T021 [P] [US1] Write Week 1-2 content in docs/module-1-ros2/week-1-2-physical-ai-intro/: foundations.md, embodied-intelligence.md, sensor-systems.md
- [ ] T022 [P] [US1] Write Week 3-5 content in docs/module-1-ros2/week-3-5-ros2-fundamentals/: ros2-architecture.md, nodes-topics-services.md, launch-files.md
- [ ] T023 [P] [US1] Create module-2-digital-twin/ directory and write Week 6-7 content: gazebo-setup.md, unity-integration.md, sensor-simulation.md
- [ ] T024 [P] [US1] Create module-3-nvidia-isaac/ directory and write Week 8-10 content: isaac-sdk.md, isaac-sim.md, isaac-ros.md, nav2.md
- [ ] T025 [P] [US1] Create module-4-vla/ directory and write Week 11-13 content: humanoid-kinematics.md, bipedal-locomotion.md, conversational-robotics.md

**Navigation & Styling**:

- [ ] T026 [US1] Configure sidebar navigation in sidebars.js with 4 modules, autogenerated items, and collapsed/expanded states
- [ ] T027 [P] [US1] Create custom CSS in src/css/custom.css with responsive design, mobile breakpoints, and code block styling
- [ ] T028 [P] [US1] Configure Prism syntax highlighting in docusaurus.config.js for Python, C++, YAML, Bash, CMake

**Deployment**:

- [ ] T029 [US1] Build Docusaurus site with `npm run build` and verify output in build/
- [ ] T030 [US1] Deploy to Vercel with `vercel --prod` and verify site is publicly accessible
- [ ] T031 [US1] Test navigation: verify all 4 modules and 13 weeks of content are accessible within 3 clicks from homepage

---

## Phase 4: User Story 2 - Ask Questions via RAG Chatbot (Priority: P2)

**Goal**: Embed interactive chatbot that answers questions based on textbook content

**Independent Test**: Open chatbot on any chapter, ask "What is ROS 2?", verify accurate response within 3 seconds with chapter references

**Content Embedding**:

- [ ] T032 [US2] Create content embedding script in scripts/embed-content.py that reads docs/, chunks content (500-800 tokens, 100-150 overlap), generates embeddings via OpenAI
- [ ] T033 [US2] Create chapter seeding script in scripts/seed-database.py that scans docs/ and populates chapters table with metadata
- [ ] T034 [US2] Run seed-database.py to populate chapters table with all 50+ chapters
- [ ] T035 [US2] Run embed-content.py to generate embeddings and store in Qdrant collection "textbook_embeddings"
- [ ] T036 [US2] Verify Qdrant collection has 5,000-10,000 vectors with correct metadata (chapter_id, section_heading, module)

**Backend Chatbot API**:

- [ ] T037 [P] [US2] Create chat routes in api/routes/chat.py with POST /api/chat and POST /api/chat/stream endpoints
- [ ] T038 [P] [US2] Implement embedding service in api/services/embeddings.py with caching (Redis optional) and batch processing
- [ ] T039 [US2] Implement chat service logic: receive query → generate embedding → query Qdrant (top 5, score >0.7) → assemble context → stream GPT-4o response
- [ ] T040 [P] [US2] Implement selected-text handling: prioritize selected text in prompt context, boost relevance in embedding
- [ ] T041 [P] [US2] Add error handling: out-of-scope detection, timeout fallbacks, rate limiting (100 req/min)

**Frontend Chatbot Widget**:

- [ ] T042 [P] [US2] Create ChatbotWidget component in src/components/ChatbotWidget.tsx with chat interface, message history, loading states
- [ ] T043 [P] [US2] Implement SSE streaming in ChatbotWidget: connect to /api/chat/stream, display chunks in real-time
- [ ] T044 [P] [US2] Add selected-text capture: detect window.getSelection(), send with query context
- [ ] T045 [P] [US2] Style chatbot widget: floating button, modal overlay, mobile-responsive design
- [ ] T046 [US2] Integrate ChatbotWidget into Docusaurus theme: add to navbar or page footer, ensure visibility on all chapter pages

**Testing & Optimization**:

- [ ] T047 [US2] Test chatbot with 20 sample questions covering all 4 modules, verify 90%+ accuracy
- [ ] T048 [US2] Measure response time for 10 queries, verify average <3 seconds
- [ ] T049 [US2] Test selected-text queries: select paragraph, ask question, verify context-aware response

---

## Phase 5: User Story 3 - Create Account and Personalize Experience (Priority: P3)

**Goal**: Implement user authentication with background questionnaire

**Independent Test**: Sign up with email/password and background questions, verify profile created, log in, verify session persists across navigation

**Authentication Routes**:

- [ ] T050 [P] [US3] Create auth routes in api/routes/auth.py with POST /api/auth/signup, POST /api/auth/login, POST /api/auth/logout, GET /api/auth/session
- [ ] T051 [P] [US3] Implement signup endpoint: validate email/password, hash password (bcrypt cost 12), save user with softwareExperience and hardwareExperience
- [ ] T052 [P] [US3] Implement login endpoint: verify credentials, create session (7 day expiration), set HTTP-only cookie
- [ ] T053 [P] [US3] Implement logout endpoint: invalidate session, clear cookie
- [ ] T054 [P] [US3] Implement session endpoint: verify cookie, return user profile or 401

**Password Reset**:

- [ ] T055 [P] [US3] Create password reset routes: POST /api/auth/password-reset/request, POST /api/auth/password-reset/confirm
- [ ] T056 [P] [US3] Implement reset request: generate token (1 hour expiration), send email (SendGrid/Resend integration)
- [ ] T057 [P] [US3] Implement reset confirm: verify token, hash new password, update user record

**Frontend Auth Components**:

- [ ] T058 [P] [US3] Create SignupForm component in src/components/SignupForm.tsx with email, password, and background questionnaire fields (software/hardware experience dropdowns)
- [ ] T059 [P] [US3] Create LoginForm component in src/components/LoginForm.tsx with email and password fields
- [ ] T060 [P] [US3] Create ForgotPassword component in src/components/ForgotPassword.tsx with email input
- [ ] T061 [P] [US3] Create ResetPassword component in src/components/ResetPassword.tsx with token and new password fields
- [ ] T062 [US3] Add auth links to Docusaurus navbar: Sign Up, Log In, User Profile (when authenticated)
- [ ] T063 [US3] Implement form validation: email format (RFC 5322), password strength (10+ chars, uppercase, lowercase, number, special char)

**Session Management**:

- [ ] T064 [US3] Test signup flow: create account, verify user in database, verify session cookie set
- [ ] T065 [US3] Test login flow: log in, verify session persists across page navigation
- [ ] T066 [US3] Test logout flow: log out, verify session cleared, verify redirect to homepage
- [ ] T067 [US3] Test password reset flow: request reset, verify email sent, reset password, verify login with new password

---

## Phase 6: User Story 4 - Personalize Chapter Content (Priority: P4)

**Goal**: Adapt chapter content based on user's skill level (beginner/intermediate/advanced)

**Independent Test**: Log in as beginner user, click "Personalize Content" on ROS 2 chapter, verify additional explanatory text appears; repeat for advanced user, verify condensed content

**Backend Personalization API**:

- [ ] T068 [P] [US4] Create content routes in api/routes/content.py with POST /api/content/personalize
- [ ] T069 [P] [US4] Create personalization service in api/services/personalization.py with GPT-4o prompts for beginner/intermediate/advanced variants
- [ ] T070 [US4] Implement personalize endpoint: check user profile → get experience level → check cache (Redis, 24h TTL) → generate personalized content → return markdown
- [ ] T071 [P] [US4] Add caching layer: cache personalized content per (chapter, level) to reduce API costs

**Frontend Personalization UI**:

- [ ] T072 [P] [US4] Create PersonalizeButton component in src/components/PersonalizeButton.tsx with "Personalize Content" and "Reset to Default" buttons
- [ ] T073 [P] [US4] Add PersonalizeButton to chapter header (MDX component or Docusaurus theme customization)
- [ ] T074 [US4] Implement personalization logic: fetch /api/content/personalize with chapterSlug → replace chapter content → persist preference in session storage
- [ ] T075 [P] [US4] Implement reset logic: clear session storage → reload original chapter content

**Preferences Persistence**:

- [ ] T076 [P] [US4] Create preferences routes: GET /api/preferences, PUT /api/preferences
- [ ] T077 [P] [US4] Implement preferences endpoints: read/write user_preferences table (personalizationEnabled, preferredLanguage, lastChapterVisited)
- [ ] T078 [US4] Test personalization persistence: personalize chapter → navigate to another chapter → verify preference persists

**Testing**:

- [ ] T079 [US4] Test beginner personalization: verify additional explanatory text, more code comments, prerequisite concepts explained
- [ ] T080 [US4] Test advanced personalization: verify condensed basics, expanded advanced topics, less verbose code
- [ ] T081 [US4] Measure content variation: verify at least 20% difference between beginner and advanced versions

---

## Phase 7: User Story 5 - Translate Content to Urdu (Priority: P5)

**Goal**: Provide Urdu translation toggle for all chapters

**Independent Test**: Click "Translate to Urdu" on any chapter, verify Urdu text appears with English code blocks and technical terms preserved

**Backend Translation API**:

- [ ] T082 [P] [US5] Create translation service in api/services/translation.py with GPT-4o translation prompts (preserve code blocks, preserve technical terms)
- [ ] T083 [P] [US5] Add POST /api/content/translate endpoint in api/routes/content.py
- [ ] T084 [US5] Implement translate endpoint: check cache (Redis, 24h TTL) → translate with GPT-4o → preserve code blocks and technical terms → return Urdu markdown
- [ ] T085 [P] [US5] Add caching layer: cache translations per (chapter, language) to reduce API costs

**Frontend Translation UI**:

- [ ] T086 [P] [US5] Create TranslateButton component in src/components/TranslateButton.tsx with "Translate to Urdu" and "Switch to English" toggle
- [ ] T087 [P] [US5] Add TranslateButton to chapter header alongside PersonalizeButton
- [ ] T088 [US5] Implement translation logic: fetch /api/content/translate with chapterSlug and targetLanguage=ur → replace chapter content → persist language preference in session storage
- [ ] T089 [P] [US5] Implement language toggle: switch between English and Urdu, persist preference across chapters

**Translation Quality**:

- [ ] T090 [US5] Test Urdu translation on 5 sample chapters: verify explanatory text translated, code blocks preserved, technical terms (ROS 2, NVIDIA Isaac) preserved in English
- [ ] T091 [US5] Verify Urdu text renders correctly with proper right-to-left (RTL) support if needed
- [ ] T092 [US5] Add disclaimer: "Automated translation - English version is authoritative"

---

## Phase 8: Polish & Cross-Cutting Concerns

**Purpose**: Final optimizations, monitoring, and deployment preparation

**Performance Optimization**:

- [ ] T093 [P] Implement multi-layer caching: semantic cache (GPTCache), embedding cache (Redis), query cache (Redis)
- [ ] T094 [P] Add connection pooling for Neon Postgres (max 10 connections) and Qdrant
- [ ] T095 [P] Enable gzip compression for API responses in FastAPI
- [ ] T096 [P] Optimize Docusaurus build: enable code splitting, lazy load tabs, optimize images with @docusaurus/plugin-ideal-image
- [ ] T097 Test page load time: verify <2 seconds on standard broadband
- [ ] T098 Test concurrent users: simulate 100 concurrent users, verify no performance degradation

**Monitoring & Observability**:

- [ ] T099 [P] Add structured logging in FastAPI with JSON format (timestamp, level, service, endpoint, userId, responseTimeMs)
- [ ] T100 [P] Create health check endpoint GET /api/health that checks database, Qdrant, OpenAI connectivity
- [ ] T101 [P] Add error tracking: log all 4xx/5xx responses with context
- [ ] T102 [P] Create cleanup scripts: scripts/cleanup-sessions.py (delete expired sessions), scripts/cleanup-chat-messages.py (delete messages >30 days)

**Security Hardening**:

- [ ] T103 [P] Implement rate limiting: 5 login attempts per minute, 100 API requests per minute per IP
- [ ] T104 [P] Add input validation and sanitization for all API endpoints (prevent SQL injection, XSS)
- [ ] T105 [P] Configure CORS: whitelist Vercel production domain only
- [ ] T106 [P] Verify all secrets in environment variables, never committed to git

**Documentation**:

- [ ] T107 [P] Create README.md with project overview, setup instructions, deployment guide
- [ ] T108 [P] Document API endpoints in api/README.md or use FastAPI auto-generated docs at /docs
- [ ] T109 [P] Create CONTRIBUTING.md with development workflow and code standards

**Final Testing**:

- [ ] T110 End-to-end test: Complete user journey from signup → read content → ask chatbot question → personalize content → translate to Urdu
- [ ] T111 Mobile responsiveness test: verify site works on mobile devices (iOS Safari, Android Chrome)
- [ ] T112 Browser compatibility test: verify site works on Chrome, Firefox, Safari, Edge
- [ ] T113 Accessibility test: verify keyboard navigation, screen reader compatibility, color contrast

**Demo Preparation**:

- [ ] T114 Create demo video (under 90 seconds) showing: homepage → chapter navigation → chatbot interaction → signup → personalization → translation
- [ ] T115 Prepare submission: GitHub repo link, deployed site link, demo video link, WhatsApp number
- [ ] T116 Final deployment: deploy to Vercel production, verify all features working, monitor logs for 1 hour

---

## Dependencies & Execution Order

### User Story Completion Order

```
Phase 1 (Setup) → Phase 2 (Foundational)
                       ↓
                    Phase 3 (US1: Content) ← MVP Milestone
                       ↓
                    Phase 4 (US2: Chatbot)
                       ↓
                    Phase 5 (US3: Auth) ← Required for US4
                       ↓
                    Phase 6 (US4: Personalization)
                       ↓
                    Phase 7 (US5: Translation)
                       ↓
                    Phase 8 (Polish)
```

### Critical Path

1. **Setup + Foundational** (T001-T018): MUST complete before any user story
2. **US1 Content** (T019-T031): MUST complete before US2 (chatbot needs content)
3. **US2 Chatbot** (T032-T049): Can proceed independently after US1
4. **US3 Auth** (T050-T067): MUST complete before US4 (personalization requires auth)
5. **US4 Personalization** (T068-T081): Depends on US1 (content) and US3 (auth)
6. **US5 Translation** (T082-T092): Depends on US1 (content), independent of US3/US4

### Parallel Execution Opportunities

**Within Phase 1 (Setup)**:
- T002-T008 can all run in parallel (different files)

**Within Phase 2 (Foundational)**:
- T011, T013, T014, T016, T017, T018 can run in parallel (different files)

**Within Phase 3 (US1 Content)**:
- T019-T025 can all run in parallel (different content files)
- T027-T028 can run in parallel with content creation

**Within Phase 4 (US2 Chatbot)**:
- T037, T038, T040, T041 can run in parallel (different backend files)
- T042-T045 can run in parallel (different frontend files)

**Within Phase 5 (US3 Auth)**:
- T050-T054 can run in parallel (different route handlers)
- T055-T057 can run in parallel (password reset routes)
- T058-T061 can run in parallel (different frontend components)

**Within Phase 6 (US4 Personalization)**:
- T068, T069, T071 can run in parallel (different backend files)
- T072, T073, T075 can run in parallel (different frontend files)

**Within Phase 7 (US5 Translation)**:
- T082, T084, T085 can run in parallel (different backend files)
- T086, T087, T089 can run in parallel (different frontend files)

**Within Phase 8 (Polish)**:
- T093-T096 can all run in parallel (different optimization areas)
- T099-T102 can all run in parallel (different monitoring components)
- T103-T106 can all run in parallel (different security measures)
- T107-T109 can all run in parallel (different documentation files)

---

## Implementation Strategy

### MVP Scope (Minimum Viable Product)

**Recommended MVP**: Phase 1 + Phase 2 + Phase 3 (US1 only)

This delivers:
- ✅ Complete textbook with 13 weeks of content
- ✅ Deployed and publicly accessible
- ✅ Navigation and search functionality
- ✅ Syntax highlighting and responsive design

**Value**: Provides core educational content (100 base points in hackathon scoring)

### Incremental Delivery

1. **Week 1**: Complete MVP (Phases 1-3) - Deploy basic textbook
2. **Week 2**: Add US2 (Chatbot) - Deploy AI-native interactive textbook
3. **Week 3**: Add US3 (Auth) - Enable user accounts
4. **Week 4**: Add US4 (Personalization) - Adaptive content (+50 bonus points)
5. **Week 5**: Add US5 (Translation) - Urdu support (+50 bonus points)
6. **Week 6**: Polish and optimize - Final deployment

### Risk Mitigation

**If time is limited**:
- Prioritize US1 (content) + US2 (chatbot) for core functionality
- US3-US5 are bonus features - implement only if time permits
- Phase 8 (Polish) can be partially skipped - focus on T110-T116 (testing and demo)

**If API costs are high**:
- Implement aggressive caching (T093) early
- Use GPT-3.5-turbo fallback for non-critical queries
- Limit translation to sample chapters only

**If content creation is slow**:
- Focus on depth over breadth - complete 2-3 modules thoroughly rather than all 4 superficially
- Use existing resources and adapt with proper attribution
- Mark incomplete sections clearly with "Coming Soon"

---

## Task Summary

**Total Tasks**: 116

**By Phase**:
- Phase 1 (Setup): 8 tasks
- Phase 2 (Foundational): 10 tasks
- Phase 3 (US1 - Content): 13 tasks
- Phase 4 (US2 - Chatbot): 18 tasks
- Phase 5 (US3 - Auth): 18 tasks
- Phase 6 (US4 - Personalization): 14 tasks
- Phase 7 (US5 - Translation): 11 tasks
- Phase 8 (Polish): 24 tasks

**By User Story**:
- US1 (Read Content): 13 tasks
- US2 (Chatbot): 18 tasks
- US3 (Auth): 18 tasks
- US4 (Personalization): 14 tasks
- US5 (Translation): 11 tasks
- Setup/Foundational: 18 tasks
- Polish: 24 tasks

**Parallelizable Tasks**: 67 tasks marked with [P]

**Estimated Timeline**: 6 weeks (assuming 1 developer, 40 hours/week)

---

## Next Steps

1. Review and approve this task breakdown
2. Begin with Phase 1 (Setup) - T001 through T008
3. Proceed to Phase 2 (Foundational) - T009 through T018
4. Implement MVP (Phase 3 - US1) - T019 through T031
5. Deploy MVP and gather feedback
6. Continue with remaining user stories in priority order
7. Complete Phase 8 (Polish) before final submission

**Ready to begin implementation!**
